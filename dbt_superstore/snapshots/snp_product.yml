version: 2

snapshots:
  - name: snp_product
    description: |
      SCD Type 2 snapshot tracking changes to product attributes over time.
      Uses check strategy to detect changes in product_name, category, and sub_category.
      Run with: dbt snapshot --select snp_product
    columns:
      - name: product_id
        description: "Natural key - unique product identifier"
        tests:
          - not_null
      - name: product_name
        description: "Product name - changes are tracked"
        tests:
          - not_null
      - name: category
        description: "Product category - changes are tracked"
        tests:
          - not_null
      - name: sub_category
        description: "Product sub-category - changes are tracked"
        tests:
          - not_null
      - name: dbt_scd_id
        description: "Unique surrogate key for each record version (auto-generated by dbt)"
        tests:
          - unique
          - not_null
      - name: dbt_valid_from
        description: "Timestamp when this version became valid"
        tests:
          - not_null
      - name: dbt_valid_to
        description: "Timestamp when this version was superseded (NULL for current)"
      - name: dbt_updated_at
        description: "Timestamp of the snapshot operation"
        tests:
          - not_null
